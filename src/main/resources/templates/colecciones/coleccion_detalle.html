<html th:replace="~{layout/base :: html}">

<div th:fragment="contenido">
    <!-- Embed de datos -->
    <script th:inline="javascript">
        /*<![CDATA[*/
        const hechos = /*[[${hechos}]]*/ [];
        const coleccionId = /*[[${coleccion.id}]]*/ null;
        /*]]>*/
    </script>

    <div class="container my-5">

        <!-- Título de la colección -->
        <section class="mb-4 text-center">
            <h1 class="display-5" th:text="${titulo}">Colección: Título de la colección</h1>
            <p class="text-muted" th:text="${descripcion}">Explora los hechos asociados a esta colección.</p>
        </section>

        <!-- Modo de navegación -->
        <section class="text-center mb-4">
            <button id="modo-curado" class="btn btn-primary me-2">Modo Curado</button>
            <button id="modo-irrestricto" class="btn btn-outline-primary">Modo Irrestricto</button>
        </section>


        <!-- Filtros -->
        <section class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Filtros</h5>
                <form id="filtros-form" class="row g-3">

                    <!-- Fecha -->
                    <div class="col-md-3">
                        <label class="form-label">Fecha desde</label>
                        <input type="date" id="filtro-fecha-desde" class="form-control">
                    </div>

                    <div class="col-md-3">
                        <label class="form-label">Fecha hasta</label>
                        <input type="date" id="filtro-fecha-hasta" class="form-control">
                    </div>


                    <!-- Ubicación -->
                    <div class="col-md-3">
                        <label for="filtro-ubicacion" class="form-label">Ubicación</label>
                        <input type="text" id="filtro-ubicacion" class="form-control" placeholder="Ej: Buenos Aires">
                    </div>

                    <!-- Categoría -->
                    <div class="col-md-3">
                        <label for="filtro-categoria" class="form-label">Categoría</label>
                        <select id="filtro-categoria" class="form-select">
                            <option value="">Todas</option>

                            <option th:each="cat : ${categorias}"
                                    th:value="${cat}"
                                    th:text="${cat}">
                                Categoría
                            </option>
                        </select>
                    </div>

                    <!-- Fuente -->
                    <div class="col-md-3">
                        <label for="filtro-fuente" class="form-label">Fuente</label>
                        <select id="filtro-fuente" class="form-select">
                            <option value="">Todas</option>

                            <option th:each="fuente : ${coleccion.fuentes}"
                                    th:value="${fuente}"
                                    th:text="${fuente}">
                                Categoría
                            </option>
                        </select>
                    </div>

                    <!-- Botón aplicar -->
                    <div class="col-12 text-end">
                        <button type="button" id="limpiar-filtros" class="btn btn-secondary">
                            Limpiar
                        </button>
                        <button type="submit" class="btn btn-success">Aplicar filtros</button>
                    </div>
                </form>
            </div>
        </section>


        <!-- Mapa -->
        <section class="mb-4">
            <h4>Mapa de hechos</h4>
            <div id="mapa-coleccion" style="height: 500px; width: 100%; border-radius: 0.5rem;"></div>
        </section>

        <div th:if="${hechos.empty}">
            No hay hechos en esta colección
        </div>
        <!-- Listado de hechos -->
        <section th:unless="${hechos.empty}">
            <h4>Listado de Hechos</h4>
            <ul id="lista-hechos" class="list-group">
                <li th:each="hecho : ${hechos}" class="list-group-item">
                    <h5 th:text="${hecho.titulo}">Título ejemplo</h5>
                    <p class="mb-1">Fuente: Agregar atributo fuente en los hechos para esto</p>
                    <small th:text="${'Fecha: ' + hecho.fecha_hecho + ' | Categoría: ' + hecho.categoria}">
                        Fecha: no encontrada | Categoría: no encontrada
                    </small>
                    <br>

                    <p>DEBUG coleccionId: <span th:text="${coleccion.id}">null</span></p>
                    <a th:href="@{/hechos/{id}(id=${hecho.id},from='coleccion',coleccionId=${coleccion.id})}"
                       class="btn btn-sm btn-outline-primary mt-2">
                        Ver detalle
                    </a>

                </li>
            </ul>
        </section>

    </div>

    <script th:src="@{/js/coleccion_detalle.js}"></script>
</div>
</html>
